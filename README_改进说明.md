# 改进版选股系统使用说明

## 📝 改进内容总结

### 1. 原始版本的问题
- ✗ 策略1通过率91.6%（4152/4533），筛选几乎无效
- ✗ 最终选出156只股票，太多难以操作
- ✗ 没有评分机制，无法判断股票质量高低
- ✗ 纯技术面，不考虑流动性和基本面

### 2. 改进版本的优化

#### 策略1增强版 (`CeLue_improved.py`)
```python
新增筛选条件:
✓ 近20日平均成交额 > 1亿（提高流动性要求）
✓ 价格在年线(MA250)之上（确保长期趋势向上）
✓ 换手率在1%-20%之间（避免过度投机或流动性不足）
```

#### 策略2评分系统 (`CeLue_improved.py`)
```python
为每只股票打分(0-100分)，综合5个维度:
1. 均线紧密度（20分）- 均线越紧密，突破后动能越强
2. 成交量放大（20分）- 量比越大，买入动力越强
3. MACD强度（20分）- MACD柱越强，趋势越明显
4. RSI动能（20分）- RSI在50-70最佳，避免超买超卖
5. 价格位置（20分）- 在20日区间中上部最佳
```

#### 智能精选机制 (`xuangu.py`)
```python
✓ 只选出得分最高的TOP 30只股票
✓ 显示精美的排名表格和评级（⭐⭐⭐⭐⭐）
✓ 自动保存结果到 selected_stocks.txt
✓ 提供直接可复制的股票代码列表
```

---

## 🚀 使用方法

### 方法1: 运行改进版（推荐）

```bash
# 进入项目目录
cd D:\PycharmProjects\stock-analysis

# 多进程运行（默认，速度快）
python xuangu.py

# 单进程运行（调试用）
python xuangu.py single
```

### 方法2: 运行原始版（对比用）

```bash
# 备份文件已保存为 xuangu_backup.py
python xuangu_backup.py
```

---

## 📊 输出结果说明

### 控制台输出示例
```
━━━━━━ 第一步: 大盘环境判断 ━━━━━━
🚀 沪深300满足买入条件，大盘环境良好！

━━━━━━ 第二步: 策略1基础筛选 ━━━━━━
使用增强版策略1: 更严格的流动性和质量标准
✓ 策略1完成: 筛选出 1250 只股票, 用时 4.23 秒

━━━━━━ 第三步: 策略2精选+评分 ━━━━━━
使用智能评分系统: 综合5个维度为每只股票打分
✓ 策略2完成: 筛选出 85 只股票, 用时 6.15 秒

━━━━━━ 第四步: 智能精选TOP 30 ━━━━━━

       📊 精选股票结果 - TOP 30 只        
┏━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┓
┃ 排名 ┃ 股票代码 ┃ 综合得分 ┃   评级   ┃
┡━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━┩
│  1   │ 600036   │   85.2   │ ⭐⭐⭐⭐⭐ │
│  2   │ 000002   │   82.7   │ ⭐⭐⭐⭐⭐ │
│  3   │ 600519   │   78.9   │  ⭐⭐⭐⭐  │
...
└──────┴──────────┴──────────┴──────────┘

✓ 结果已保存到: selected_stocks.txt
```

### 结果文件 (selected_stocks.txt)
```
选股时间: 2026-01-20 14:30:25
总用时: 12.50 秒
选出股票数: 30 只

排名	股票代码	得分
1	600036	85.2
2	000002	82.7
3	600519	78.9
...
```

---

## 🎯 投资建议

### 根据得分选择策略

| 得分区间 | 评级 | 建议操作 |
|---------|------|---------|
| 80-100分 | ⭐⭐⭐⭐⭐ | 重点关注，优先买入 |
| 70-79分 | ⭐⭐⭐⭐ | 可以考虑，适度配置 |
| 60-69分 | ⭐⭐⭐ | 谨慎观察，小仓位试探 |
| 50-59分 | ⭐⭐ | 暂时观望 |
| <50分 | ⭐ | 不建议买入 |

### 风险控制要点

1. **大盘环境**
   - ✓ 沪深300向好时买入
   - ✗ 沪深300不好时观望

2. **仓位管理**
   - 每只股票不超过总资金的5%
   - TOP 5的股票可以适当多配（8-10%）
   - 总仓位不超过70%，保留30%现金

3. **止盈止损**
   - 固定止损：-8%
   - 固定止盈：+15%
   - 技术止损：跌破MA10
   - 回撤止盈：从最高点回撤12%

4. **分批操作**
   - 不要一次性全仓买入
   - 建议分3批建仓（首批30%，观察后再加仓）

---

## 🔧 自定义配置

### 修改精选数量
编辑 `xuangu.py` 文件，找到：
```python
# 精选股票数量配置
TOP_N_STOCKS = 30  # 改为你想要的数量，如 20、50 等
```

### 调整评分权重
编辑 `CeLue_improved.py` 中的 `策略2_精选版` 函数：
```python
# 1. 均线紧密度（20分）← 可以改为30分提高权重
# 2. 成交量放大（20分）
# 3. MACD强度（20分）
# 4. RSI动能（20分）
# 5. 价格位置（20分）
```

### 修改策略1筛选条件
编辑 `CeLue_improved.py` 中的 `策略1_增强版` 函数：
```python
# 近20日平均成交额 > 1亿 ← 可以改为5000万降低门槛
近20日平均成交额 = A.iloc[-20:].mean()
条件1 = 近20日平均成交额 > 100000000  # 改为 50000000
```

---

## ⚠️ 注意事项

1. **回测验证**
   - 在实际投资前，建议先运行回测
   - 命令：`python huice.py`
   - 查看策略在历史数据上的表现

2. **数据更新**
   - 确保通达信数据已更新到最新
   - 定期运行数据导入脚本

3. **交易时段**
   - 交易时段(9:00-16:00)会获取实时行情
   - 非交易时段使用昨日收盘数据

4. **免责声明**
   - 本策略仅供参考，不构成投资建议
   - 股市有风险，投资需谨慎
   - 请根据自己的风险承受能力做出决策

---

## 📈 下一步建议

1. **运行回测**
   ```bash
   python huice.py
   ```
   查看策略在2022-2025年的历史表现

2. **小资金试验**
   - 用1-2万元试验1-2个月
   - 严格执行止损止盈策略

3. **持续优化**
   - 记录每次选股结果和实际表现
   - 根据市场变化调整参数

4. **关注基本面**
   - 对于得分最高的股票，建议人工再看看财报
   - 避开业绩地雷股

---

## 🆘 常见问题

**Q: 为什么选出的股票还是太多？**
A: 可以降低 `TOP_N_STOCKS` 的值，比如改为20或15。

**Q: 如果找不到符合条件的股票怎么办？**
A: 说明当前市场环境不适合这个策略，建议观望或放宽条件。

**Q: 改进版和原始版可以同时运行吗？**
A: 可以。改进版是 `xuangu.py`，原始版是 `xuangu_backup.py`。

**Q: 评分系统可靠吗？**
A: 评分系统基于技术指标，需要结合基本面分析。建议关注得分≥70的股票。

---

## 📞 技术支持

如有问题，可以：
1. 查看代码注释
2. 运行测试：`python CeLue.py`
3. 检查日志文件

祝投资顺利！🎉
